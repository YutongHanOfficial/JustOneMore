<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Coin Flip — 80% / -50% Game</title>
  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --accent:#7c3aed; --muted:#9aa4b2; --glass: rgba(255,255,255,0.04);
      --glass-2: rgba(255,255,255,0.03);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial; background:linear-gradient(180deg,#071021 0%, #071b2a 60%);color:#e6eef6}
    .wrap{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:40px}
    .card{width:100%;max-width:980px;background:linear-gradient(180deg,var(--card), #051019);border-radius:18px;padding:28px;box-shadow:0 8px 30px rgba(2,6,23,0.7);display:grid;grid-template-columns:320px 1fr;gap:22px}
    header{grid-column:1/-1;display:flex;align-items:center;justify-content:space-between}
    h1{font-size:20px;margin:0}
    p.lead{margin:6px 0 0;color:var(--muted);font-size:13px}

    .left{display:flex;flex-direction:column;gap:18px}
    .balance{background:linear-gradient(180deg,var(--glass),var(--glass-2));padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.04)}
    .balance .amount{font-size:28px;font-weight:700;letter-spacing:0.3px}
    .meta{margin-top:8px;color:var(--muted);font-size:13px}

    .coin-wrap{display:flex;align-items:center;justify-content:center;padding:18px;border-radius:12px;background:conic-gradient(from 0deg,var(--accent),#2dd4bf, #f59e0b);height:180px}
    /* coin */
    .coin{width:120px;height:120px;border-radius:50%;background:radial-gradient(circle at 30% 30%, #fff9, transparent 20%), linear-gradient(180deg,#ffd972 0%, #ffb020 60%);display:grid;place-items:center;position:relative;transform-style:preserve-3d;transition:transform 1s cubic-bezier(.2,.9,.3,1);box-shadow:0 10px 30px rgba(0,0,0,0.6)}
    .coin .face{position:absolute;inset:0;display:grid;place-items:center;font-weight:700;font-size:18px;backface-visibility:hidden}
    .coin .heads{transform:rotateY(0deg)}
    .coin .tails{transform:rotateY(180deg)}

    .controls{display:flex;gap:12px;align-items:center}
    button.btn{background:var(--accent);border:0;color:white;padding:12px 16px;border-radius:10px;font-weight:700;cursor:pointer;box-shadow:0 6px 18px rgba(124,58,237,0.12)}
    button.ghost{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:10px 12px;border-radius:10px}
    button:disabled{opacity:0.5;cursor:not-allowed}

    .right{display:flex;flex-direction:column;gap:14px}
    .history{background:linear-gradient(180deg,#071827, #04121b);padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);min-height:140px;overflow:auto}
    .row{display:flex;justify-content:space-between;padding:8px 6px;border-bottom:1px dashed rgba(255,255,255,0.02);font-size:14px}
    .row:last-child{border-bottom:0}

    .small{font-size:12px;color:var(--muted)}

    footer.notes{grid-column:1/-1;margin-top:6px;color:var(--muted);font-size:12px}

    /* animations */
    .spinning{animation:spinCoin 1s cubic-bezier(.2,.9,.3,1) forwards}
    @keyframes spinCoin{0%{transform:rotateY(0)} 100%{transform:rotateY(1800deg)}}

    @media (max-width:880px){.card{grid-template-columns:1fr;max-width:720px}.left{order:2}.right{order:1}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <header>
        <div>
          <h1>Coin Flip — 80% / -50%</h1>
          <p class="lead">Start with $100. Heads = +80% ; Tails = -50%. Flip as many times as you like.</p>
        </div>
        <div class="small">Simple HTML / CSS / JS • Works on GitHub Pages</div>
      </header>

      <div class="left">
        <div class="balance">
          <div class="small">Current Balance</div>
          <div class="amount" id="balance">$100.00</div>
          <div class="meta">Flips: <span id="flips">0</span> • Net change: <span id="net">0%</span></div>
        </div>

        <div class="coin-wrap">
          <div id="coin" class="coin" aria-hidden="true">
            <div class="face heads">HEADS</div>
            <div class="face tails">TAILS</div>
          </div>
        </div>

        <div class="controls">
          <button id="flipBtn" class="btn">Flip Coin</button>
          <button id="resetBtn" class="ghost">Reset</button>
          <button id="autoBtn" class="ghost">Auto x10</button>
        </div>
      </div>

      <div class="right">
        <div class="history" id="history">
          <!-- flips appended here -->
        </div>

        <div style="display:flex;justify-content:space-between;align-items:center">
          <div class="small">Tip: Expected multiplier per flip = (0.5*1.8 + 0.5*0.5) = 1.15 (positive)</div>
          <div class="small">Precision: 2 decimals</div>
        </div>
      </div>

      <footer class="notes">Buttons: Flip — single flip. Auto x10 — perform 10 flips with short delays. Reset — back to $100.</footer>
    </div>
  </div>

  <script>
    (function(){
      const START = 100;
      let balance = START;
      let flips = 0;
      const balanceEl = document.getElementById('balance');
      const flipsEl = document.getElementById('flips');
      const netEl = document.getElementById('net');
      const historyEl = document.getElementById('history');
      const coin = document.getElementById('coin');
      const flipBtn = document.getElementById('flipBtn');
      const resetBtn = document.getElementById('resetBtn');
      const autoBtn = document.getElementById('autoBtn');

      function fmt(n){return '$' + n.toLocaleString(undefined,{minimumFractionDigits:2,maximumFractionDigits:2})}
      function pct(n){return (n>=0?'+':'') + n.toFixed(2) + '%'}

      function updateUI(){
        balanceEl.textContent = fmt(balance);
        flipsEl.textContent = flips;
        const net = (balance - START)/START*100;
        netEl.textContent = pct(net);
      }

      function pushHistory(result, oldBal, newBal){
        const row = document.createElement('div');
        row.className = 'row';
        row.innerHTML = `<div><strong>${result.toUpperCase()}</strong><div class="small">Old: ${fmt(oldBal)}</div></div><div style="text-align:right">${fmt(newBal)}<div class="small">${result==='heads'?'+80%':'-50%'}</div></div>`;
        historyEl.prepend(row);
      }

      function singleFlip(animate=true){
        if(flipBtn.disabled) return;
        flipBtn.disabled = true;
        resetBtn.disabled = true;
        autoBtn.disabled = true;

        // animation
        if(animate){
          coin.classList.remove('spinning');
          // force reflow
          void coin.offsetWidth;
          coin.classList.add('spinning');
        }

        // pick result (50/50)
        const r = Math.random() < 0.5 ? 'heads' : 'tails';
        // apply multiplier
        const old = balance;
        if(r === 'heads') balance = balance * 1.8;
        else balance = balance * 0.5;
        // rounding
        balance = Math.round(balance * 100) / 100;
        flips += 1;

        // set coin face to reflect result after animation (halfway)
        setTimeout(()=>{
          if(r === 'heads') coin.style.transform = 'rotateY(0deg)';
          else coin.style.transform = 'rotateY(180deg)';
        }, 300);

        // finish
        setTimeout(()=>{
          updateUI();
          pushHistory(r, old, balance);
          flipBtn.disabled = false;
          resetBtn.disabled = false;
          autoBtn.disabled = false;
        }, 1000);
      }

      flipBtn.addEventListener('click',()=> singleFlip(true));
      resetBtn.addEventListener('click',()=>{
        balance = START; flips = 0; historyEl.innerHTML=''; updateUI();
      });

      autoBtn.addEventListener('click', async ()=>{
        if(autoBtn.disabled) return;
        flipBtn.disabled = true; resetBtn.disabled = true; autoBtn.disabled = true;
        const times = 10;
        for(let i=0;i<times;i++){
          singleFlip(true);
          // wait for one second per flip
          await new Promise(r=>setTimeout(r, 1200));
        }
        flipBtn.disabled = false; resetBtn.disabled = false; autoBtn.disabled = false;
      });

      // init
      updateUI();

    })();
  </script>
</body>
</html>
